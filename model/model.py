import torch

weight1 = torch.tensor([[-3.1569, -2.0255, -4.9251,  2.0673,  3.0950,  1.1834, -1.6070,  0.3334,
            4.2335, -3.7145],
           [-0.9783, -1.7761,  4.9706, -9.1617, -2.8742, -1.6577, -0.9980, -3.2860,
            -4.3648,  3.4592],
           [-1.3727, -8.8277, -5.1524,  7.0985,  2.9211,  4.6437,  2.3041, -1.4119,
            3.8487, -3.8910],
           [-7.2315, -5.1569, -9.7431,  4.1138,  6.1984,  2.6177, -3.7565,  0.6573,
            8.6961, -7.2823],
           [-3.3581, -2.2985, -4.9383,  2.0598,  3.0825,  1.1931, -1.7015,  0.3281,
            4.2547, -3.8046],
           [-1.3926, -2.3420,  5.0128, -9.1075, -2.7844, -1.6151, -1.0629, -3.1814,
            -4.3209,  3.3646],
           [ 0.6679,  7.9094, -4.2587,  4.2271,  3.2518, -2.3113, -1.4972,  5.3749,
             4.3031, -3.7874],
           [-6.9734, -5.2852,  5.2398,  4.0880, -2.8025,  3.0076, -3.2853,  0.4542,
            -4.7872,  3.6367],
           [-3.3995, -2.3504, -4.9863,  2.0626,  3.1276,  1.1719, -1.7806,  0.3897,
            4.2314, -3.7925],
           [-1.8065, -0.3860,  4.1411, 11.3057, -3.2616,  3.0331, -0.4623,  3.7551,
            -5.2662,  4.5643]])

weight2 = torch.tensor([[ 4.8718,  5.5138, -7.7763, -3.5296],
           [-4.6301, -7.8461,  6.8762,  3.0582],
           [ 8.7842, -2.2432,  1.6074, -8.8257],
           [ 2.7088,  8.3183, -5.8836, -4.8061],
           [-8.6270,  2.2688, -3.7972,  7.2499],
           [-2.4861, -7.6829,  6.6909,  3.0622],
           [-3.1778, -4.9482,  2.7474,  3.6431],
           [-0.8321, -4.5002,  2.5647,  2.7118],
           [ 7.4398, -4.4695,  1.2368, -9.1596],
           [-7.2563,  2.1489, -2.1138,  7.6877]])

bias1 = torch.tensor([  8.7050,   2.9763,   3.2054,  -9.2285, -11.2134,  -6.7197,   4.3857,
             -2.4803,  -9.4097,  -1.7847])

bias2 = torch.tensor([-3.2233,  2.2377, -3.0637,  4.0493])


def model_output(x, w1, b1, w2, b2):
    a1 = torch.matmul(x.float(), w1) + b1
    h1 = a1.sigmoid()
    a2 = torch.matmul(h1, w2) + b2
    h2 = a2.exp()/a2.exp().sum(-1).unsqueeze(-1)
    return h2
