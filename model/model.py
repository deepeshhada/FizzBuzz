import torch

weight1 = torch.tensor([[-0.6944, -0.0443, -6.6311, -3.6459, -1.2927, -1.2228,  3.0496, -1.7922,
         -3.3342, -3.0343],
        [ 5.5665, -2.7345, -3.3545,  7.7491,  0.4037,  8.9999, -6.0989, -0.5442,
         -1.3754, -1.0436],
        [-3.1113,  2.2193, -1.5089,  3.6805, -1.8407, -5.1361, -3.5455,  6.1749,
         -0.5085,  8.1509],
        [-2.2315,  1.1432, 11.7978, -7.9617, -0.8616, -2.5140,  6.1834, -3.5641,
          5.3696, -4.7245],
        [-0.6388, -0.0484, -6.6596, -3.6421, -1.7676, -1.2376,  3.0394, -1.8469,
         -3.3356, -2.9481],
        [ 5.5851, -2.7818, -3.4416,  7.7323, -0.1792,  9.0042, -6.0675, -0.6485,
         -1.3394, -0.8331],
        [-3.1697,  2.2295, -1.5488,  3.6631, -2.5984, -4.9585, -3.4647,  6.1683,
         -0.5578,  8.2976],
        [-2.2326,  1.2100, 11.8038, -7.8886, -1.3093, -2.5484,  6.1836, -3.5529,
          5.4342, -4.6747],
        [-0.6904, -0.0772, -6.6569, -3.6313, -1.4863, -1.2473,  3.0501, -1.8462,
         -3.3660, -2.9701],
        [ 5.5853, -2.7924, -3.4494,  7.7268, -0.1379,  8.9959, -6.0567, -0.6561,
         -1.3483, -0.8286]])

weight2 = torch.tensor([[-7.2184,  1.4175,  2.8765,  3.8067],
        [ 3.7677,  2.1646, -2.3836, -5.2074],
        [-6.7956, -3.9424,  2.1915,  6.3089],
        [ 7.4504, -9.8125, -4.0813,  8.4329],
        [ 0.6915,  1.7129, -2.4121, -1.8710],
        [ 3.8096,  5.8971, -3.6448, -5.1715],
        [ 4.6785, -8.0330, -5.8156,  8.9299],
        [-4.8768, -1.9950,  2.6524,  3.2244],
        [ 5.7309,  0.6606, -1.8891, -5.8391],
        [ 0.9466,  7.4080, -5.5790, -2.9601]])

bias1 = torch.tensor([ 1.8648,  4.3398,  2.4896, -2.4380,  1.8503, -3.3085, -1.8997,  2.8693,
        -0.5544, -2.3150])

bias2 = torch.tensor([-0.0274, -1.3271,  3.3746, -2.0202])


def model_output(x, w1, b1, w2, b2):
    a1 = torch.matmul(x.float(), w1) + b1
    h1 = a1.sigmoid()
    a2 = torch.matmul(h1, w2) + b2
    h2 = a2.exp()/a2.exp().sum(-1).unsqueeze(-1)
    return h2
